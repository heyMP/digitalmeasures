<?php
/**
 * Creates a test email entry in the Listserv_Verify Table and verifies that the
 * keys are correctly active and inactive.
 *
 * @todo Need create a test for checking the confirmation link was posted.
 */
class DigitalMeasuresTestCase extends DrupalWebTestCase {
  /**
   * Implements getInfo().
   */
  public static function getInfo() {
    return array (
      'name' => t('Digital Measures'),
      'description' => t('Functional test for the Digital Measures module.'),
      'group' => t('Digital Measures'),
    );
  }

  public function setUp() {
    // Enable any module that you will need in your tests.
    parent::setUp('digitalmeasures');
    // Set variables
    variable_set('digitalmeasures_username', 'test');
    variable_set('digitalmeasures_password', 'test');
  }

  public function testGet() {
    $arguments = array(
      'USERNAME' => array('mgp140','btopro'),
      'CAMPUS' => array('UP')
    );
    $request = digitalmeasures_digitalmeasures_get_schemadata($arguments, 'xml');
    $request_get = $request->request;
    preg_match('#GET /login/service/v4/SchemaData/INDIVIDUAL-ACTIVITIES-University/USERNAME:mgp140,USERNAME:btopro,CAMPUS:UP#', $request_get, $matches);

    $this->assertTrue(isset($matches[0]));
  }
}

